<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
</head>
<body>
    <div th:fragment="notification-bell">
        <link rel="stylesheet" th:href="@{/css/notification-bell.css}" />
        
        <div class="notification-bell-container" id="notificationBell">
            <a th:href="@{/notifications}" class="notification-bell">
                <div id="lottie-bell"></div>
                <span class="notification-badge" style="display: none;">0</span>
            </a>
        </div>

        <!-- Add Lottie Library -->
        <script src="https://cdnjs.cloudflare.com/ajax/libs/bodymovin/5.7.6/lottie.min.js"></script>
        <script>
            document.addEventListener('DOMContentLoaded', function() {
                // Initialize Lottie animation
                const animation = bodymovin.loadAnimation({
                    container: document.getElementById('lottie-bell'),
                    renderer: 'svg',
                    loop: false,
                    autoplay: false,
                    path: '/js/notfication-bell.js'
                });

                const bell = document.getElementById('lottie-bell');
                const badge = document.querySelector('.notification-badge');

                // Play animation on hover
                bell.addEventListener('mouseenter', () => {
                    animation.play();
                });

                bell.addEventListener('mouseleave', () => {
                    animation.stop();
                });

                // Function to update notification count
                function updateNotificationCount() {
                    fetch('/notifications/count')
                        .then(response => response.json())
                        .then(data => {
                            if (data.count > 0) {
                                badge.style.display = 'flex';
                                badge.textContent = data.count;
                                animation.play();
                            } else {
                                badge.style.display = 'none';
                            }
                        });
                }

                // Update count initially and every 30 seconds
                updateNotificationCount();
                setInterval(updateNotificationCount, 30000);
            });
        </script>
    </div>
</body>
</html> 